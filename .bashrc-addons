#!/bin/bash -xe

LOG_INDENT=""

log_indent_inc() {
    LOG_INDENT="$LOG_INDENT""\t"
}

log_indent_dec() {
    LOG_INDENT=$(echo "$LOG_INDENT" | sed 's/\(.*\).$/\1/g')
}

log_begin() {
    echo -e "$LOG_INDENT""$1"
    log_indent_inc
}

log_end() {
    log_indent_dec
    echo -e "$LOG_INDENT""$1"
}

log() {
    echo -e "$LOG_INDENT""$1"
}

log_begin "bashrc-addons"

path_add() {
    local p="$1"
    if ! echo $PATH | tr ':' '\n' | grep -qx "$p"
    then
        export PATH=$PATH:"$p"
    fi
}

log "go setup"
export GOROOT=$HOME/usr/local/go
path_add "$GOROOT/bin"

log "add bin to PATH"
path_add "$HOME/bin"

log "general env vars"
export EDITOR='emacsclient -nw'

log "setup aliases"
unalias l
unalias g
alias em='emacsclient -nw'
alias gl='git log --graph --all --oneline --decorate'

log "setup some functions"
function c() {
    cd $1
    l
    hr
    pwd | h '.'
}


log "setup java"
[ -n "$(which java)" ] && export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java))))

log "setup autojump"
autojump --version 2> /dev/null || 
    echo autojump not found! install with: sudo aptitude install autojump
. /usr/share/autojump/autojump.sh

log "setup hhighlighter"
. $(dirname $(readlink -f ~/.bashrc-addons))/lib/hhighlighter/h.sh

log "setup dockviz"
alias dockviz="docker run -it --rm -v /var/run/docker.sock:/var/run/docker.sock nate/dockviz"

. ./.bashrc-addons.local
